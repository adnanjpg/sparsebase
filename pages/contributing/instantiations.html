<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Instantiating Classes in SparseBase &mdash; SparseBase v0.3.1 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/collapsible-lists/css/tree_view.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/collapsible-lists/js/CollapsibleLists.compressed.js"></script>
        <script src="../../_static/collapsible-lists/js/apply-collapsible-lists.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Testing" href="testing_guide.html" />
    <link rel="prev" title="Making Contributions to the Repo" href="github_guide.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> SparseBase
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../getting_started/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../explanations/index.html">Explanations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../how_to_guides/index.html">How To Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/library_root.html">Library API</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Contributing</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="dependencies.html">Adding New Dependencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="documentation_guide.html">Documentation Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="github_guide.html">Making Contributions to the Repo</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Instantiating Classes in SparseBase</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#template">Template</a></li>
<li class="toctree-l3"><a class="reference internal" href="#filename">Filename</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ifdef">Ifdef</a></li>
<li class="toctree-l3"><a class="reference internal" href="#folder">Folder</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="testing_guide.html">Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="testing_guide.html#running-tests">Running tests</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License (MIT)</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">SparseBase</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="index.html">Contributing</a> &raquo;</li>
      <li>Instantiating Classes in SparseBase</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/pages/contributing/instantiations.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section class="tex2jax_ignore mathjax_ignore" id="instantiating-classes-in-sparsebase">
<h1>Instantiating Classes in SparseBase<a class="headerlink" href="#instantiating-classes-in-sparsebase" title="Permalink to this headline"></a></h1>
<p>While SparseBase supports a header-only mode, our main focus is in the compiled version of the library.
This is mainly due to the large impact of header-only mode on the build times of user’s projects.</p>
<p>AsAbsolute a result of this, we try to keep the header files as light as possible by avoiding putting implementations there.
There are a few exceptions to this (like the <code class="docutils literal notranslate"><span class="pre">AsAbsolute&lt;&gt;()</span></code> function of <code class="docutils literal notranslate"><span class="pre">Format</span></code>)
but this is only done in very rare situations.</p>
<p>Hence, any templated class or function you create in SparseBase will require instantiation as it needs to be compiled
with the library with the types known at compile time. This is achieved with the script
<code class="docutils literal notranslate"><span class="pre">src/generate_explicit_instantiations.py</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This script is not intended to be called manually besides debugging. It will be called automatically
by CMake during the configuration step.</p>
</div>
<p>To add a new instantiation you need to call the following function. Each parameter is explained in its own section.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">gen_inst</span><span class="p">(</span><span class="n">template</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">ifdef</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">folder</span><span class="o">=</span><span class="n">output_folder</span><span class="p">):</span>
</pre></div>
</div>
<section id="template">
<h2>Template<a class="headerlink" href="#template" title="Permalink to this headline"></a></h2>
<p><strong>Example:</strong> <code class="docutils literal notranslate"><span class="pre">CSR&lt;$id_type,</span> <span class="pre">$nnz_type,</span> <span class="pre">$value_type&gt;</span></code></p>
<p>The following operations will be performed on the template you provide:</p>
<ol class="arabic simple">
<li><p>Template will be placed in <code class="docutils literal notranslate"><span class="pre">template</span> <span class="pre">class</span> <span class="pre">&lt;your_template&gt;;\n</span></code></p></li>
<li><p>The identifiers starting with <code class="docutils literal notranslate"><span class="pre">$</span></code> will be replaced with their counterparts in the CMake variables. Currently, we have
<code class="docutils literal notranslate"><span class="pre">$id_type</span></code>, <code class="docutils literal notranslate"><span class="pre">$nnz_type</span></code>, <code class="docutils literal notranslate"><span class="pre">$value_type</span></code>, <code class="docutils literal notranslate"><span class="pre">$float_type</span></code>. Every possible combination will be covered.</p></li>
</ol>
</section>
<section id="filename">
<h2>Filename<a class="headerlink" href="#filename" title="Permalink to this headline"></a></h2>
<p>The filename to be used for the output. AsAbsolute per <a class="reference external" href="https://google.github.io/styleguide/cppguide.html">Google’s Style Guide</a>,
the filenames we use end with the <code class="docutils literal notranslate"><span class="pre">.inc</span></code> extension.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If the file is being used for the first time you should also call the <code class="docutils literal notranslate"><span class="pre">reset_file()</span></code> function with it.
Otherwise you may encounter duplicate instantiation errors</p>
</div>
</section>
<section id="ifdef">
<h2>Ifdef<a class="headerlink" href="#ifdef" title="Permalink to this headline"></a></h2>
<p>This is an optional parameter. If used, the instantiations will be surrounded with an <code class="docutils literal notranslate"><span class="pre">#ifdef</span> <span class="pre">...</span> <span class="pre">#endif</span></code> using the
string provided in this parameter as the definition name.</p>
<p><strong>Example:</strong></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Generated when the function is called with ifdef=&quot;USE_METIS&quot; </span>
<span class="cp">#ifdef USE_METIS</span>
<span class="k">template</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">MetisPartition</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="p">,</span><span class="kt">double</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>
<span class="k">template</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">MetisPartition</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="p">,</span><span class="kt">float</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>
<span class="cp">#endif</span>
</pre></div>
</div>
</section>
<section id="folder">
<h2>Folder<a class="headerlink" href="#folder" title="Permalink to this headline"></a></h2>
<p>By default, the script will put everything in the <code class="docutils literal notranslate"><span class="pre">output_folder</span></code> argument passed by CMake.
This optional parameter can be used to override that.
Generally you will want to use this to open a new folder under <code class="docutils literal notranslate"><span class="pre">output_folder</span></code>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Files under different folders are different from each other. And as a result the <code class="docutils literal notranslate"><span class="pre">reset_file()</span></code>
function must be called on each file separately. Note that <code class="docutils literal notranslate"><span class="pre">reset_file()</span></code> also takes an optional folder
parameter for this purpose.</p>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="github_guide.html" class="btn btn-neutral float-left" title="Making Contributions to the Repo" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="testing_guide.html" class="btn btn-neutral float-right" title="Testing" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, SparCity Project.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>